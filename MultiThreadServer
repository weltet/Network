import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;

class ConnectionThread extends Thread{
	private Socket sock = null;
	private DataInputStream dis;
	private DataOutputStream dos;
	private ArrayList<Socket> clients;
	
	public ConnectionThread(Socket sock) {
		try {
		this.sock = sock;
		clients.add(this.sock);
		dis = new DataInputStream(sock.getInputStream());
		dos = new DataOutputStream(sock.getOutputStream());
		}catch(Exception e) {
			e.printStackTrace();
		}
	}
	
	public void run() {
		try {
			
		System.out.println(sock.getInetAddress()+" connected");
		
		
		while(true) {
		String msg = dis.readUTF();
		
		for(Socket s:clients) {
			s.getOutputStream();
			
			
		}
		
		}
		
		}catch(Exception e) {
			e.printStackTrace();
		}
	}
	
	
}

public class MultiThreadServer {
	public static void main(String[] args) throws Exception {
		ServerSocket server = new ServerSocket(20000);
		
		while(true) {
		ConnectionThread th = new ConnectionThread(server.accept()); 
		th.start();
		}
		
		
	}
}
